  **原文链接**：[https://bitshares.org/technology/dynamic-account-permissions/](https://bitshares.org/technology/dynamic-account-permissions/)
 
 **译者**：[https://github.com/b-t-s-1](b-t-s-1)
 
 **校对者**： 
  
***    


# 动态帐户权限

#### 企业环境管理

BitShares围绕设计权限，而不是加密，使其易于使用。每个帐户都可以通过其他帐户和私钥的任何加权组合进行控制。这创建了一个层次结构，反映了现实生活中权限的组织方式，使多用户对资金的控制变得前所未有的简单。多用户控制是安全性的最大贡献者，如果使用得当，它几乎可以消除因黑客攻击而导致的盗窃风险。 

***

## 背景

在区块链上对敏感操作要求多个数字签名的能力是平台安全性不可或缺的。当单个密钥可能受到危害，分布在多个位置的多个密钥会增加冗余保护，这将带来更安全的体验。

竞争区块链系统存在以下缺点：

* M-of-N模型不能充分反映许多现实生活组织的管理层次结构。
* M密钥的等权重不足以表示帐户的不对称所有权。
* 协调和签署必须完全在带外进行。
* 如果不与所有其他方协调，则无法更改密钥。
* 等待其他方时，签名无法撤回。

## 用例

多签名技术都是关于权限管理的，权限应该根据人员或组织而不是密钥来定义。考虑一个由3个人经营的示例公司：Alice，Bob和Carol。Alice和Bob各自拥有公司40％的股份，Carol拥有20％的股份。该公司要求3个人中的的2个人批准所有费用。你可以根据分配给Alice，Bob和Carol的密钥来定义公司，但如果Alice想保护她拥有多重签名检查的自己的身份，该怎么办？Alice选择使用服务提供商，该服务提供商对Alice做的每个动作执行双因素身份验证。这可以保护Alice和公司，公司不需要更改其权限结构以适应Alice选择双因素身份验证提供程序。

![](https://bitshares.org/images/dynamic-accounts.png)

## 解决方案

我们根据分配了全局唯一ID的帐户引入了一种新的权限方法。

在这个系统下，可以定义一个本身没有密钥的帐户，而是仅依赖于其他帐户的批准。相应的，这些其他帐户可能依赖于其他帐户的批准。此过程形成必须授予权限的帐户层次结构。每个帐户都可以独立于层次结构中位于其上方的任何帐户更改自己的动态权限。

每个帐户将其权限定义为一组密钥和/或其他帐户ID，每个帐户ID都有帐户持有人。如果密钥和/或帐户的组合权重超过帐户定义的阈值，则许可被授予。

第二种解决方案是在包括在共识状态中，将部分签名的交易，允许帐户发布添加或删除其批准的交易。这简化了签名协调问题，使人们能够在达到阈值之前改变主意，并在收到最终批准后立即申请交易。

执行需要多签名权限交易的过程如下：

1. 有人建议进行交易并用他们的账户批准。
2. 其他账户持有人广播交易，在提案中添加“是”或“否”。
3. 当拟议的交易获得所有账户的批准时，即确认。

## Owner 和 Active 密钥

每个帐户都分配了两种权限：owner和active。

* *authority*是一组密钥和/或帐户，每个密钥和/或帐户都分配了权重。
* 每个*authority*都有一个权重阈值，必须在要求执行*authority*的操作之前越过。
* *owner authority*用于冷存储，其主要作用是更新*active authority*或更改*owner authority*。
* *active authority*意味着是一个热键，可以执行任何操作，除了更改*owner authority*。
* 激励用例是一个双因素身份验证提供程序，作为*active authority*的共同签名者，但不是*owner authority*。

通过这种方法，用户可以保持自信，他们的帐户将永远在他们的控制之下，然而这种控制可以保存在冷藏库中，没有人可以破解它。这意味着公司帐户可以要求其批准董事会和每个董事会成员可能需要的双因素身份验证。

任何人都可以频繁地轮换密钥，而不必干扰其用户帐户的权限。

## 收集签名

过去难以使用多重签名方法的挑战之一是收集这些方法的行为所需签名完全是手动的，或者需要专门的基础设施。一旦交易签署，就无法收回您的签名，因此签署的最后一方比其他方略有优势。随着更深层次的层次结构，收集签名变得更加复杂。

为简化此过程，区块链应通过批准的拟议交易的部分状态跟踪来管理签名收集过程。在此过程中，每个帐户都可以原子地添加（或删除）他们对交易的权限，而不必依赖在外部系统上传播交易。这对于任意深度的层次结构尤其重要。

为了使计算受限，单个交易只会遍历层次结构中的两个层。如果存在两层以上的层次结构，则帐户必须建议（创建一个交易）批准提案（另一项交易）。当第一个提案（交易）获得批准时，会将权限添加到第二个提案（交易）中。

根据这种方法，每个人在每次批准某项行动时，都会支付一笔交易费最多涉及网络的1个签名验证。此过程允许形成任意深层次结构，而不会将权限系统暴露给漏洞无限计算。

## 可伸缩性

理论上，帐户可以形成任意深度的层次结构，并且评估该层次结构可以是任意时长时间。实际上，单个交易不可能有超过2个级别的签名，这使他们的计算有限。任何需要超过2个级别的东西都可能涉及很多
人，并不会立刻签署。相反，它将使用内置的建议交易基础设施，跟踪部分批准的交易。.

* 通过这种方法，董事会成员可以建议他的公司批准交易。
* 这可以在逻辑上扩展到建议和帐户建议，以批准交易。
* 此过程将收集交易费用，因为层次结构中的所有层都逐渐添加其权限，并且没有时间需要无限制的计算。

## 周期

两个帐户可能要求彼此批准交易。

想象一下，创建了需要A和Y批准的帐户X。
想象一下，创建了需要B和X批准的帐户Y.
该图如下所示：

```
   A -> X <-> Y
   B -> Y <-> X
```

A建议X花费1个BTS并等待Y的批准。
B建议Y批准A的提案并等待X的批准。

由于以下原因，无法通过任何一方的单一批准解决此问题：

1. 这两个账户中如果没有另一个账户采取行动，因此无法实现任何目标。
2. 循环不必是直接的，因为在这种情况下，它们可能涉及任意长的序列，因此是不明显的。
3. 如果用户在*active authority*中创建批准循环，则*owner authority* 可用于中断循环;但是，如果他们在*owner authority*和*active authority*中构建一个循环，则循环中涉及的帐户将被锁定。
4. 实际上，客户端软件可以检测循环并防止它们形成。


## 结论

动态分层阈值多重签名权限为人员和组织提供了更自然的方式表达所有权和控制政策。与现有解决方案相比，这种方法使系统更易于使用，并且最终更安全。

## 信用

Ripple wiki有一个独立发现的记录在案但没有实现的类似多签名功能的提议。



