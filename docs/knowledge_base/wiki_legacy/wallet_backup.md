  **原文链接**：[https://dev.bitshares.works/en/master/knowledge_base/wiki_legacy/wallet_backup.html](https://dev.bitshares.works/en/master/knowledge_base/wiki_legacy/wallet_backup.html)
 
 **译者**：[https://github.com/b-t-s-1](b-t-s-1)
 
 **校对者**： 
  
***

钱包备份
========================

钱包备份实现
-----------------------------------

本文档的目的是概述自动备份的要求，以防止资金损失。 当用户清除所有缓存和cookie时，很容易意外删除基于Web的钱包，并且不是保存不可恢复信息的安全位置。 因此，必须以安全的方式备份钱包数据。

跟踪备份状态
-----------------------------------

钱包备份的最低要求是用户将其钱包的加密副本下载到浏览器缓存/数据存储之外的磁盘。 每当新的，不可恢复的数据被添加到钱包中时，用户界面需要在每个屏幕的页脚上指示“备份推荐”。 当用户点击“备份”时，它应该自动将钱包下载到他们的下载文件夹，而不需要其他操作。 理想情况下，用户无需单击任何内容即可触发自动保存到Download的文件夹。

自动上传到投递箱
-----------------------------------

该过程可以自动化，作为在本地下载钱包的替代（或补充）。

加密钱包
-----------------------------------

备份仅与保护加密数据的密码一样安全。 出于保护备份的目的，典型的用户密码不太理想，因此优选的是相对于brain密钥加密备份。 用户希望记下并物理存储，然后远离可能丢失的数字设备。

brainkey可用于派生公钥。 当钱包被加密时，生成一次性私钥并与公共brain密钥组合以生成将用作AES密码的一次性密钥。

用户将能够使用他们的brain密钥恢复任何备份，但不需要他们的私有brain密钥来加密他们的备份。

在新设备上访问钱包
-----------------------------------

远程备份的第二个目的是允许用户通过简单地输入brain密钥轻松地将钱包加载到新设备上。使用诸如Drop Box或Github之类的第三方服务来跟踪备份会使在新计算机上加载钱包的过程变得复杂。如果所有备份都是无缝的并且不需要签名或授权第三方服务，则用户将获得更好的体验。

用户应该能够将他们的加密钱包上传到钱包服务器，然后不知道除了brain密钥之外的任何东西。服务器需要一种安全，自动的方式来验证请求上传或下载钱包，而无需外部验证。

为了实现这个钱包存储和检索将需要验证从brain密钥导出的WALLET_KEY。私有WALLET_KEY保存在用户的设备上，仅受其简单密码的保护。只要用户的本地钱包解锁，就可以上传备份。

当用户从新设备登录Web服务时，他们必须提供他们的BRAIN_KEY，这将允许他们生成他们的WALLET_KEY，从而验证从服务器下载钱包的请求。服务器将使用PUBLIC_WALLET_KEY作为唯一标识符来查找钱包。

避免删除数据
-----------------------------------

当用户对服务器进行备份时，应保存旧版本的钱包。 这样可以防止攻击本地钱包的攻击者用错误的备份覆盖好的备份。

钱包数据应该被压缩
-----------------------------------

为节省服务器空间，应在加密前压缩钱包数据。

防止滥用
-----------------------------------

任何允许用户上传任意二进制数据的服务都有可能被滥用来存储钱包备份以外的数据。 有几种方法可以防止滥用：

1. 要求所有钱包密钥属于区块链上注册的帐户
1. 将自动备份限制为由一组帐户引用的帐户
1. 限制备份钱包的更新频率
1. 限制备份钱包的下载频率
1. 将自动备份限制为列入白名单的帐户
1. 将自动备份限制为具有最小余额的帐户
1. 要求每次备份都有工作证明


限制责任
-----------------------------------

应仅为方便起见提供帐户备份，不应依赖帐户备份作为在所有情况下恢复钱包文件的方法。 如果提供商不能或不愿意生成备份钱包的副本，则服务提供商应有让所有用户放弃起诉的权利。 用户还应同意允许服务提供商以公共方式发布所有备份钱包，例如github存储库，因此服务提供商不对数据泄露负责。

